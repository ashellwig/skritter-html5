- var vacation = view.subscription.get('vacation');
- var subscribed = view.subscription.get('subscribed');

gelato-page(data-name='billing-subscription')
  .container
    .content-block
      .row
        .col-md-3.sidebar
          #settings-sidebar-container
          
        .col-md-9.main-content
          .title Subscription

          if view.subscription.state === 'fetching'
            p.text-center
              i.fa.fa-3x.fa-spinner.fa-pulse

          else
            .form-horizontal
              .form-group.form-group-lg
                label.control-label.col-sm-3 Account status
                .col-sm-9
                  p.form-control-static= view.subscription.getStatus()
                  
              .form-group.form-group-lg
                label.control-label.col-sm-3 Expires
                .col-sm-9
                  p.form-control-static
                    - var expires = view.subscription.get('expires');
                    if expires
                      | #{moment(expires).format('LL')}
                      if vacation
                        .help-block
                          | This date will be moved forward when your vacation
                          | ends, for as long as the vacation was in effect.
                        
                    else
                      | Never
                    
              - var couponError = view.coupon.error;
              - var couponUsed = view.coupon.wasUsed;
              .form-group.form-group-lg(class=couponError ? 'has-error' : couponUsed ? 'has-success' : '' )
                label.control-label.col-sm-3 Coupon code
                .col-sm-4
                  input#code-input.form-control(value=view.coupon.get('code'))
                  if couponError
                    .help-block= couponError
                  if couponUsed
                    .help-block Coupon used successfully
                .col-sm-2
                  if view.coupon.state === 'standby'
                    button#redeem-code-btn.btn.btn-fixed.btn-success
                      | Redeem code
                  else
                    button.btn.btn-fixed.btn-success(disabled=true)
                      i.fa.fa-1x.fa-spinner.fa-pulse

              .form-group.form-group-lg
                label.control-label.col-sm-3 Vacation
                .col-sm-9
                  p.form-control-static
                    if vacation
                      span= moment(vacation.begin).format('dddd, MMMM Do')
                      span.spr.spl -
                      span.spr= moment(vacation.end).format('dddd, MMMM Do')
                      span#cancel-vacation-wrapper
                        a#cancel-vacation-link Cancel
                        i#cancel-vacation-spinner.fa.fa-1x.fa-spinner.fa-pulse.hide
                    else
                      a#go-on-vacation-link Go on vacation
                      
              hr
              
              if subscribed === 'ios'
                .title Apple Subscriptions
                .alert.alert-info
                  p
                    | Your subscription is controlled through Apple.
                    | To cancel or get more info about your subscription,
                    | please go to iTunes.

                  p 
                    | If you would like to pay with a credit card here,
                    | or through some other service, such as Paypal or Google
                    | Play, first you should unsubscribe from your Apple Skritter
                    | subscription. Otherwise you may be erroneously billed twice.
                  
                  button.btn.btn-block.btn-primary#unsubscribe-itunes-btn
                    span I have unsubscribed through iTunes
                    i.fa.fa-1x.fa-spinner.fa-pulse.hide
                    
              if subscribed === 'paypal'
                .title Paypal Subscriptions
                .alert.alert-info
                  p
                    | Your subscription is controlled through Paypal.
                    | To cancel or get more info about your subscription,
                    | please go to
                    a.spl(href="https://www.paypal.com/" target="_blank") the Paypal website
                    | .

                  p 
                    | If you would like to pay with a credit card here,
                    | or through some other service, such as Apple or Google
                    | Play, first you should unsubscribe from your Paypal Skritter
                    | subscription. Otherwise you may be erroneously billed twice.

                              
            
                  

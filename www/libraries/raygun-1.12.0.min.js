/*! Raygun4js - v1.12.0 - 2014-09-22
* https://github.com/MindscapeHQ/raygun4js
* Copyright (c) 2014 MindscapeHQ; Licensed MIT */
(function(e){function n(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function t(e){return e===undefined}var r={},o=e.TraceKit,i=[].slice,a="?";r.noConflict=function(){return e.TraceKit=o,r},r.wrap=function(e){function n(){try{return e.apply(this,arguments)}catch(n){throw r.report(n),n}}return n},r.report=function(){function t(e){c(),g.push(e)}function o(e){for(var n=g.length-1;n>=0;--n)g[n]===e&&g.splice(n,1)}function a(e,t){var o=null;if(!t||r.collectWindowErrors){for(var a in g)if(n(g,a))try{g[a].apply(null,[e].concat(i.call(arguments,2)))}catch(u){o=u}if(o)throw o}}function u(e,n,t,o,i){var u=null;if(i)u=r.computeStackTrace(i);else if(m)r.computeStackTrace.augmentStackTraceWithInitialElement(m,n,t,e),u=m,m=null,p=null;else{var c={url:n,line:t,column:o};c.func=r.computeStackTrace.guessFunctionName(c.url,c.line),c.context=r.computeStackTrace.gatherContext(c.url,c.line),u={mode:"onerror",message:e,url:document.location.href,stack:[c],useragent:navigator.userAgent}}return a(u,"from window.onerror"),s?s.apply(this,arguments):!1}function c(){f!==!0&&(s=e.onerror,e.onerror=u,f=!0)}function l(n){var t=i.call(arguments,1);if(m){if(p===n)return;var o=m;m=null,p=null,a.apply(null,[o,null].concat(t))}var u=r.computeStackTrace(n);throw m=u,p=n,e.setTimeout(function(){p===n&&(m=null,p=null,a.apply(null,[u,null].concat(t)))},u.incomplete?2e3:0),n}var s,f,g=[],p=null,m=null;return l.subscribe=t,l.unsubscribe=o,l}(),r.computeStackTrace=function(){function o(n){if(!r.remoteFetching)return"";try{var t=function(){try{return new e.XMLHttpRequest}catch(n){return new e.ActiveXObject("Microsoft.XMLHTTP")}},o=t();return o.open("GET",n,!1),o.send(""),o.responseText}catch(i){return""}}function i(e){if(!n(b,e)){var t="";e=e||"",e.indexOf&&-1!==e.indexOf(document.domain)&&(t=o(e)),b[e]=t?t.split("\n"):[]}return b[e]}function u(e,n){var r,o=/function ([^(]*)\(([^)]*)\)/,u=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,c="",l=10,s=i(e);if(!s.length)return a;for(var f=0;l>f;++f)if(c=s[n-f]+c,!t(c)){if(r=u.exec(c))return r[1];if(r=o.exec(c))return r[1]}return a}function c(e,n){var o=i(e);if(!o.length)return null;var a=[],u=Math.floor(r.linesOfContext/2),c=u+r.linesOfContext%2,l=Math.max(0,n-u-1),s=Math.min(o.length,n+c-1);n-=1;for(var f=l;s>f;++f)t(o[f])||a.push(o[f]);return a.length>0?a:null}function l(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function s(e){return l(e).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function f(e,n){for(var t,r,o=0,a=n.length;a>o;++o)if((t=i(n[o])).length&&(t=t.join("\n"),r=e.exec(t)))return{url:n[o],line:t.substring(0,r.index).split("\n").length,column:r.index-t.lastIndexOf("\n",r.index)-1};return null}function g(e,n,t){var r,o=i(n),a=RegExp("\\b"+l(e)+"\\b");return t-=1,o&&o.length>t&&(r=a.exec(o[t]))?r.index:null}function p(n){for(var t,r,o,i,a=[e.location.href],u=document.getElementsByTagName("script"),c=""+n,g=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,p=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,m=0;u.length>m;++m){var h=u[m];h.src&&a.push(h.src)}if(o=g.exec(c)){var d=o[1]?"\\s+"+o[1]:"",v=o[2].split(",").join("\\s*,\\s*");t=l(o[3]).replace(/;$/,";?"),r=RegExp("function"+d+"\\s*\\(\\s*"+v+"\\s*\\)\\s*{\\s*"+t+"\\s*}")}else r=RegExp(l(c).replace(/\s+/g,"\\s+"));if(i=f(r,a))return i;if(o=p.exec(c)){var y=o[1];if(t=s(o[2]),r=RegExp("on"+y+"=[\\'\"]\\s*"+t+"\\s*[\\'\"]","i"),i=f(r,a[0]))return i;if(r=RegExp(t),i=f(r,a))return i}return null}function m(e){if(!e.stack)return null;for(var n,t,r=/^\s*at (?:((?:\[object object\])?\S+(?: \[as \S+\])?) )?\(?((?:file|http|https|chrome-extension):.*?):(\d+)(?::(\d+))?\)?\s*$/i,o=/^\s*(\S*)(?:\((.*?)\))?@?((?:file|http|https).*?):(\d+)(?::(\d+))?\s*$/i,i=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:ms-appx|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,l=e.stack.split("\n"),s=[],f=/^(.*) is undefined$/.exec(e.message),p=0,m=l.length;m>p;++p){if(n=o.exec(l[p]))t={url:n[3],func:n[1]||a,args:n[2]?n[2].split(","):"",line:+n[4],column:n[5]?+n[5]:null};else if(n=r.exec(l[p]))t={url:n[2],func:n[1]||a,line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=i.exec(l[p])))continue;t={url:n[2],func:n[1]||a,line:+n[3],column:n[4]?+n[4]:null}}!t.func&&t.line&&(t.func=u(t.url,t.line)),t.line&&(t.context=c(t.url,t.line)),s.push(t)}return s[0]&&s[0].line&&!s[0].column&&f&&(s[0].column=g(f[1],s[0].url,s[0].line)),s.length?{mode:"stack",name:e.name,message:e.message,url:document.location.href,stack:s,useragent:navigator.userAgent}:null}function h(e){for(var n,t=e.stacktrace,r=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,o=t.split("\n"),i=[],a=0,l=o.length;l>a;a+=2)if(n=r.exec(o[a])){var s={line:+n[1],column:+n[2],func:n[3]||n[4],args:n[5]?n[5].split(","):[],url:n[6]};if(!s.func&&s.line&&(s.func=u(s.url,s.line)),s.line)try{s.context=c(s.url,s.line)}catch(f){}s.context||(s.context=[o[a+1]]),i.push(s)}return i.length?{mode:"stacktrace",name:e.name,message:e.message,url:document.location.href,stack:i,useragent:navigator.userAgent}:null}function d(t){var r=t.message.split("\n");if(4>r.length)return null;var o,a,l,g,p=/^\s*Line (\d+) of linked script ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,m=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,h=/^\s*Line (\d+) of function script\s*$/i,d=[],v=document.getElementsByTagName("script"),y=[];for(a in v)n(v,a)&&!v[a].src&&y.push(v[a]);for(a=2,l=r.length;l>a;a+=2){var x=null;if(o=p.exec(r[a]))x={url:o[2],func:o[3],line:+o[1]};else if(o=m.exec(r[a])){x={url:o[3],func:o[4]};var w=+o[1],S=y[o[2]-1];if(S&&(g=i(x.url))){g=g.join("\n");var b=g.indexOf(S.innerText);b>=0&&(x.line=w+g.substring(0,b).split("\n").length)}}else if(o=h.exec(r[a])){var k=e.location.href.replace(/#.*$/,""),T=o[1],O=RegExp(s(r[a+1]));g=f(O,[k]),x={url:k,line:g?g.line:T,func:""}}if(x){x.func||(x.func=u(x.url,x.line));var j=c(x.url,x.line),R=j?j[Math.floor(j.length/2)]:null;x.context=j&&R.replace(/^\s*/,"")===r[a+1].replace(/^\s*/,"")?j:[r[a+1]],d.push(x)}}return d.length?{mode:"multiline",name:t.name,message:r[0],url:document.location.href,stack:d,useragent:navigator.userAgent}:null}function v(e,n,t,r){var o={url:n,line:t};if(o.url&&o.line){e.incomplete=!1,o.func||(o.func=u(o.url,o.line)),o.context||(o.context=c(o.url,o.line));var i=/ '([^']+)' /.exec(r);if(i&&(o.column=g(i[1],o.url,o.line)),e.stack.length>0&&e.stack[0].url===o.url){if(e.stack[0].line===o.line)return!1;if(!e.stack[0].line&&e.stack[0].func===o.func)return e.stack[0].line=o.line,e.stack[0].context=o.context,!1}return e.stack.unshift(o),e.partial=!0,!0}return e.incomplete=!0,!1}function y(e,n){for(var t,o,i,c=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,l=[],s={},f=!1,m=y.caller;m&&!f;m=m.caller)if(m!==x&&m!==r.report){if(o={url:null,func:a,line:null,column:null},m.name?o.func=m.name:(t=c.exec(""+m))&&(o.func=t[1]),i=p(m)){o.url=i.url,o.line=i.line,o.func===a&&(o.func=u(o.url,o.line));var h=/ '([^']+)' /.exec(e.message||e.description);h&&(o.column=g(h[1],i.url,i.line))}s[""+m]?f=!0:s[""+m]=!0,l.push(o)}n&&l.splice(0,n);var d={mode:"callers",name:e.name,message:e.message,url:document.location.href,stack:l,useragent:navigator.userAgent};return v(d,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),d}function x(e,n){var t=null;n=null==n?0:+n;try{if(t=h(e))return t}catch(r){if(S)throw r}try{if(t=m(e))return t}catch(r){if(S)throw r}try{if(t=d(e))return t}catch(r){if(S)throw r}try{if(t=y(e,n+1))return t}catch(r){if(S)throw r}return{mode:"failed"}}function w(e){e=(null==e?0:+e)+1;try{throw Error()}catch(n){return x(n,e+1)}}var S=!1,b={};return x.augmentStackTraceWithInitialElement=v,x.guessFunctionName=u,x.gatherContext=c,x.ofCaller=w,x}(),function(){var n=function n(n){var t=e[n];e[n]=function(){var e=i.call(arguments),n=e[0];return"function"==typeof n&&(e[0]=r.wrap(n)),t.apply?t.apply(this,e):t(e[0],e[1])}};n("setTimeout"),n("setInterval")}(),r.remoteFetching||(r.remoteFetching=!0),r.collectWindowErrors||(r.collectWindowErrors=!0),(!r.linesOfContext||1>r.linesOfContext)&&(r.linesOfContext=11),e.TraceKit=r})(window),function(e,n){"use strict";if(e){var t=e.event.add;e.event.add=function(r,o,i,a,u){var c;return i.handler?(c=i.handler,i.handler=n.wrap(i.handler)):(c=i,i=n.wrap(i)),i.guid=c.guid?c.guid:c.guid=e.guid++,t.call(this,r,o,i,a,u)};var r=e.fn.ready;e.fn.ready=function(e){return r.call(this,n.wrap(e))};var o=e.ajax;e.ajax=function(t,r){"object"==typeof t&&(r=t,t=void 0),r=r||{};for(var i,a=["complete","error","success"];i=a.pop();)e.isFunction(r[i])&&(r[i]=n.wrap(r[i]));try{return t?o.call(this,t,r):o.call(this,r)}catch(u){throw n.report(u),u}}}}(window.jQuery,window.TraceKit),function(e,n,t){function r(e){var n=e,t=e.split("//")[1];if(t){var r=t.indexOf("?"),o=(""+t).substring(0,r),i=o.split("/").slice(0,4).join("/"),a=o.substring(0,48);n=i.length<a.length?i:a,n!==o&&(n+="..")}return n}function o(e,n,o,i){var a="AJAX Error: "+(n.statusText||"unknown")+" "+(o.type||"unknown")+" "+(r(o.url)||"unknown");(!A||n.getAllResponseHeaders())&&H.send(i||e.type,{status:n.status,statusText:n.statusText,type:o.type,url:o.url,ajaxErrorMessage:a,contentType:o.contentType,requestData:o.data&&o.data.slice?o.data.slice(0,10240):t,responseData:n.responseText&&n.responseText.slice?n.responseText.slice(0,10240):t})}function i(n,t){e.console&&e.console.log&&D&&(e.console.log(n),t&&e.console.log(t))}function a(){return b&&""!==b?!0:(i("Raygun API key has not been configured, make sure you call Raygun.init(yourApiKey)"),!1)}function u(e,n){var t,r={};for(t in e)r[t]=e[t];for(t in n)r[t]=n[t];return r}function c(e,n){return null!=n?e.concat(n):e}function l(e,n){for(var t=0;e.length>t;t++)n.call(null,t,e[t])}function s(e){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}function f(){return Math.floor(9007199254740992*Math.random())}function g(){var n=document.documentElement,t=document.getElementsByTagName("body")[0],r=e.innerWidth||n.clientWidth||t.clientWidth,o=e.innerHeight||n.clientHeight||t.clientHeight;return{width:r,height:o}}function p(e){var n=(new Date).toJSON();try{var r="raygunjs="+n+"="+f();localStorage[r]===t&&(localStorage[r]=e)}catch(o){i("Raygun4JS: LocalStorage full, cannot save exception")}}function m(){try{return"localStorage"in e&&null!==e.localStorage}catch(n){return!1}}function h(){if(m()&&localStorage.length>0)for(var e in localStorage)"raygunjs="===e.substring(0,9)&&(x(JSON.parse(localStorage[e])),localStorage.removeItem(e))}function d(e,n){if(O)if(Array.prototype.indexOf&&O.indexOf===Array.prototype.indexOf){if(-1!==O.indexOf(e))return"[removed by filter]"}else for(var t=0;O.length>t;t++)if(O[t]===e)return"[removed by filter]";return n}function v(e){if(null==e)return e;if("[object Object]"!==Object.prototype.toString.call(e))return e;for(var n in e){var t=e[n];null!=t&&(e[n]="[object Object]"===Object.prototype.toString.call(t)?v(t):d(n,t))}return e}function y(n,r){var o=[],a={};if(!$||n.stack&&n.stack.length){n.stack&&n.stack.length&&l(n.stack,function(e,n){o.push({LineNumber:n.line,ColumnNumber:n.column,ClassName:"line "+n.line+", column "+n.column,FileName:n.url,MethodName:n.func||"[anonymous]"})}),e.location.search&&e.location.search.length>1&&l(e.location.search.substring(1).split("&"),function(e,n){var t=n.split("=");if(t&&2===t.length){var r=decodeURIComponent(t[0]),o=d(r,t[1]);a[r]=o}}),r===t&&(r={}),s(r.customData)&&(r.customData="function"==typeof M?M():M),s(r.tags)&&(r.tags="function"==typeof I?I():I);var u=e.screen||{width:g().width,height:g().height,colorDepth:8},c=r.customData&&r.customData.ajaxErrorMessage,f=v(r.customData);try{JSON.stringify(f)}catch(p){var m="Cannot add custom data; may contain circular reference";f={error:m},i("Raygun4JS: "+m)}var h={OccurredOn:new Date,Details:{Error:{ClassName:n.name,Message:c||n.message||r.status||"Script error",StackTrace:o},Environment:{UtcOffset:(new Date).getTimezoneOffset()/-60,"User-Language":navigator.userLanguage,"Document-Mode":document.documentMode,"Browser-Width":g().width,"Browser-Height":g().height,"Screen-Width":u.width,"Screen-Height":u.height,"Color-Depth":u.colorDepth,Browser:navigator.appCodeName,"Browser-Name":navigator.appName,"Browser-Version":navigator.appVersion,Platform:navigator.platform},Client:{Name:"raygun-js",Version:"1.12.0"},UserCustomData:f,Tags:r.tags,Request:{Url:[location.protocol,"//",location.host,location.pathname].join(""),QueryString:a,Headers:{"User-Agent":navigator.userAgent,Referer:document.referrer,Host:document.domain}},Version:T||"Not supplied"}};if(k&&(h.Details.User=k),"function"==typeof j){var y=j(h);y&&x(y)}else x(h)}}function x(e){if(a()){i("Sending exception data to Raygun:",e);var n=U+"/entries?apikey="+encodeURIComponent(b);S(n,JSON.stringify(e))}}function w(n,t){var r;return r=new e.XMLHttpRequest,"withCredentials"in r?r.open(n,t,!0):e.XDomainRequest&&(N&&(t=t.slice(6)),r=new e.XDomainRequest,r.open(n,t)),r.timeout=1e4,r}function S(n,r){var o=w("POST",n,r);return"withCredentials"in o?(o.onreadystatechange=function(){4===o.readyState&&(202===o.status?h():F&&403!==o.status&&400!==o.status&&p(r))},o.onload=function(){i("logged error to Raygun")}):e.XDomainRequest&&(o.ontimeout=function(){F&&(i("Raygun: saved error locally"),p(r))},o.onload=function(){i("logged error to Raygun"),h()}),o.onerror=function(){i("failed to log error to Raygun")},o?(o.send(r),t):(i("CORS not supported"),t)}var b,k,T,O,j,R,E=TraceKit.noConflict(),C=e.Raygun,D=!1,N=!1,A=!1,F=!1,$=!1,M={},I=[],U="https://api.raygun.io";n&&(R=n(document));var H={noConflict:function(){return e.Raygun=C,H},init:function(e,n,t){return b=e,E.remoteFetching=!1,M=t,n&&(N=n.allowInsecureSubmissions||!1,A=n.ignoreAjaxAbort||!1,n.debugMode&&(D=n.debugMode),n.ignore3rdPartyErrors&&($=!0)),h(),H},withCustomData:function(e){return M=e,H},withTags:function(e){return I=e,H},attach:function(){return a()?(E.report.subscribe(y),R&&R.ajaxError(o),H):H},detach:function(){return E.report.unsubscribe(y),R&&R.unbind("ajaxError",o),H},send:function(e,n,t){try{y(E.computeStackTrace(e),{customData:"function"==typeof M?u(M(),n):u(M,n),tags:c(I,t)})}catch(r){if(e!==r)throw r}return H},setUser:function(e,n,t,r,o,i){return k={Identifier:e},n&&(k.IsAnonymous=n),t&&(k.Email=t),r&&(k.FullName=r),o&&(k.FirstName=o),i&&(k.UUID=i),H},setVersion:function(e){return T=e,H},saveIfOffline:function(e){return e!==t&&"boolean"==typeof e&&(F=e),H},filterSensitiveData:function(e){return O=e,H},onBeforeSend:function(e){return j=e,H}};e.Raygun=H}(window,window.jQuery);